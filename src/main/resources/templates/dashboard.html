
<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--  <meta charset="UTF-8">-->
<!--  <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--  <title>User Dashboard</title>-->
<!--  <link rel="stylesheet" href="../css/style.css">-->
<!--    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">-->
<!--  <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>-->
<!--  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>-->
<!--</head>-->
<!--<body>-->
<!--&lt;!&ndash; header and other content &ndash;&gt;-->

<!--<h1 class="text-center">User Dashboard</h1>-->
<!--<hr>-->
<!--<div class="container pagination-container">-->
<!--  <div class="row dashboard">-->
<!--    &lt;!&ndash; Initial watchlist card removed &ndash;&gt;-->
<!--  </div>-->
<!--</div>-->
<!--<button type="button" class="create-watchlist-button btn btn-primary">Create Watchlist</button>-->

<!--&lt;!&ndash; Add watchlist modal &ndash;&gt;-->
<!--<div class="modal fade" id="addWatchlistModal" tabindex="-1" aria-labelledby="addWatchlistModalLabel" aria-hidden="true">-->
<!--  <div class="modal-dialog">-->
<!--    <div class="modal-content">-->
<!--      <div class="modal-header">-->
<!--        <h5 class="modal-title" id="addWatchlistModalLabel">Add Watchlist</h5>-->
<!--        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>-->
<!--      </div>-->
<!--      <div class="modal-body">-->
<!--        <form>-->
<!--          <div class="mb-3">-->
<!--            <label for="watchlistTitle" class="form-label">Watchlist Title</label>-->
<!--            <input type="text" class="form-control" id="watchlistTitle" placeholder="Enter watchlist title">-->
<!--          </div>-->

<!--&lt;!&ndash;          <div class="mb-3">&ndash;&gt;-->
<!--&lt;!&ndash;            <label for="cryptoCoinCount" class="form-label">Crypto Coin Count</label>&ndash;&gt;-->
<!--&lt;!&ndash;            <input type="number" class="form-control" id="cryptoCoinCount" placeholder="Enter the number of crypto coins">&ndash;&gt;-->
<!--&lt;!&ndash;          </div>&ndash;&gt;-->
<!--        </form>-->
<!--        <div class=" mb-3 ">-->
<!--          <input id="search" type="text"   oninput="if($('#search').val() !== null){searchQuery($('#search').val())} "class="form-control form-control-dark text-bg-dark" placeholder="Search..." aria-label="Search">-->
<!--        </div>-->
<!--        <div><ul id="searchResults"></ul></div>-->
<!--      </div>-->
<!--      <div>-->
<!--        <h6>Added coins:</h6>-->
<!--        <ul id="addedCoins"></ul>-->
<!--      </div>-->
<!--      <div class="modal-footer">-->
<!--        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>-->
<!--        <button type="button" class="btn btn-primary" id="addWatchlistDoneButton">Done</button>-->
<!--      </div>-->
<!--    </div>-->
<!--  </div>-->
<!--</div>-->
<!--<script src="https://code.jquery.com/jquery-3.6.4.min.js" integrity="sha256-oP6HI9z1XaZNBrJURtCoUT5SUnxFr8s3BzRl+cbzUq8=" crossorigin="anonymous"></script>-->
<!--<script>-->
<!--  const maxCardsPerPage = 8; // Maximum number of cards per page-->
<!--  let currentPage = 1;-->

<!--  // Event listener for create-watchlist-button-->
<!--  document.querySelector(".create-watchlist-button").addEventListener("click", function () {-->
<!--    const modalElement = document.getElementById("addWatchlistModal");-->
<!--    const modalInstance = new bootstrap.Modal(modalElement);-->
<!--    modalInstance.show();-->
<!--  });-->

<!--  // updatePagination function-->
<!--  function updatePagination() {-->
<!--    const dashboardPages = document.querySelectorAll(".dashboard");-->
<!--    dashboardPages.forEach((page, index) => {-->
<!--      if (index + 1 === currentPage) {-->
<!--        page.style.display = "flex";-->
<!--      } else {-->
<!--        page.style.display = "none";-->
<!--      }-->
<!--    });-->
<!--  }-->

<!--  // createNewPage function-->
<!--  function createNewPage() {-->
<!--    const newPage = document.createElement("div");-->
<!--    newPage.classList.add("row", "dashboard");-->
<!--    newPage.style.display = "none";-->
<!--    document.querySelector(".pagination-container").appendChild(newPage);-->
<!--  }-->

<!--  // Other code (maxCardsPerPage, currentPage, event listener for create-watchlist-button, updatePagination, createNewPage)-->

<!--  document.getElementById("addWatchlistDoneButton").addEventListener("click", function () {-->
<!--    const title = document.getElementById("watchlistTitle").value;-->
<!--    const count = document.getElementById("cryptoCoinCount").value;-->
<!--    const dashboardContainer = document.querySelector(".dashboard");-->
<!--    addWatchlistCard(dashboardContainer, title, count);-->

<!--    // Reset form and close the modal-->
<!--    document.getElementById("watchlistTitle").value = "";-->
<!--    document.getElementById("cryptoCoinCount").value = "";-->
<!--    const modalElement = document.getElementById("addWatchlistModal");-->
<!--    const modalInstance = bootstrap.Modal.getInstance(modalElement);-->
<!--    modalInstance.hide();-->
<!--  });-->

<!--  function addWatchlistCard(container, title, count) {-->
<!--    // Create the dashboard-card elements-->
<!--    const dashboardCard = document.createElement("div");-->
<!--    dashboardCard.classList.add("dashboard-card", "col-lg-3", "card", "border-primary", "mb-3");-->

<!--    const cardHeader = document.createElement("h5");-->
<!--    cardHeader.classList.add("card-header");-->
<!--    cardHeader.textContent = title || "New Watchlist";-->

<!--    const cardBody = document.createElement("div");-->
<!--    cardBody.classList.add("card-body");-->

<!--    const cryptoCoinCount = document.createElement("p");-->
<!--    cryptoCoinCount.classList.add("card-text");-->
<!--    cryptoCoinCount.textContent = "Crypto Coins: " + (count || "0");-->

<!--    const cardButton = document.createElement("button");-->
<!--    cardButton.classList.add("card-button", "btn", "btn-primary");-->
<!--    cardButton.textContent = "Edit Watchlist";-->

<!--    // Append the elements to the dashboard-card-->
<!--    cardBody.appendChild(cryptoCoinCount);-->
<!--    cardBody.appendChild(cardButton);-->
<!--    dashboardCard.appendChild(cardHeader);-->
<!--    dashboardCard.appendChild(cardBody);-->

<!--    // Append the new dashboard-card to the container-->
<!--    container.appendChild(dashboardCard);-->


<!--  }-->
<!--  const searchQuery = (input) => {-->
<!--    $('#searchResults').empty();-->
<!--    try {-->
<!--      $.getJSON(`https://api.coingecko.com/api/v3/search?query=${input}`)-->
<!--              .done(function (data) {-->
<!--                let info = data.coins;-->
<!--                $('#searchResults').append(`<span style="background:rgba(255,255,255,0.5);z-index: 12;position: relative;right: -96%;top: 21px;color:red;cursor:pointer;" onclick="$('#searchResults').empty()">X</span>`);-->
<!--                info.forEach((coin) => {-->
<!--                  let marketCap = coin.market_cap_rank;-->
<!--                  if (marketCap == null) {-->
<!--                    return "NA";-->
<!--                  }-->
<!--                  let searchContent = "";-->
<!--                  searchContent +=-->
<!--                          `<li><span>#${marketCap} </span><a href="${coin.id}"><img src="${coin.thumb}" alt="${coin.id}">${coin.symbol} ${coin.id}</a></li>`;-->
<!--                  $('#searchResults').append(searchContent);-->
<!--                });-->
<!--              });-->
<!--    } catch (error) {-->
<!--      console.error("Error fetching data:", error);-->
<!--    }-->
<!--  };-->

<!--  function debounce(func, wait) {-->
<!--    let timeout;-->
<!--    return function (...args) {-->
<!--      const context = this;-->
<!--      clearTimeout(timeout);-->
<!--      timeout = setTimeout(() => {-->
<!--        func.apply(context, args);-->
<!--      }, wait);-->
<!--    };-->
<!--  }-->

<!--  const debouncedFunction = debounce(searchQuery, 300);-->

<!--  $('#search').on('input', function () {-->
<!--    $('#searchResults').empty();-->
<!--    debouncedFunction($(this).val());-->
<!--  });-->

<!--  let addedCoins = [];-->

<!--  // Event listener for adding coins-->
<!--  $('#searchResults').on('click', 'a', function (event) {-->
<!--    event.preventDefault();-->

<!--    const coinId = $(this).text().trim();-->
<!--    const coinHref = $(this).attr('href');-->

<!--    // Check if the coin is already added-->
<!--    if (addedCoins.some(coin => coin.id === coinHref)) {-->
<!--      alert('Coin already added to the watchlist.');-->
<!--      return;-->
<!--    }-->

<!--    // Add the coin to the addedCoins array-->
<!--    addedCoins.push({ id: coinHref, name: coinId });-->

<!--    // Display the added coin in the "addedCoins" list-->
<!--    $('#addedCoins').append(`<li data-id="${coinHref}">${coinId}</li>`);-->
<!--  });-->

<!--</script>-->

<!--</body>-->
<!--</html>-->


<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html" >
<head>
  <meta charset="UTF-8">
  <meta th:name="_csrf" th:content="${_csrf.token}"/>
  <meta th:name="_csrf_header" th:content="${_csrf.headerName}"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User Dashboard</title>
  <link rel="stylesheet" href="../css/dashboard.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.4/font/bootstrap-icons.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</head>
<body>

<!-- header and other content -->
<header>


</header>

<main>

  <!--the coin table chart lives in the tabpanel div, each tab button calls getChart() with different queries-->
  <div class="container">
    <section class="row">
      <div class="d-flex align-items-start">
        <div class="nav col-md-2 flex-column nav-pills me-3" id="v-pills-tab" role="tablist" aria-orientation="vertical">
          <!-- Add the "Create Watchlist" button after the "Watchlist 1" button -->
          <button class="nav-link" id="create-watchlist-btn" data-bs-toggle="modal" data-bs-target="#createWatchlistModal" type="button">Create Watchlist</button>

          <!-- Create the modal with the form -->
          <div class="modal fade" id="createWatchlistModal" tabindex="-1" aria-labelledby="createWatchlistModalLabel" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="createWatchlistModalLabel">Create Watchlist</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">

                  <form id="create-watchlist-form">

                    <div class="mb-3">
                      <label for="watchlist-name" class="form-label">Watchlist Name</label>
                      <input type="text" class="form-control" id="watchlist-name" required>
                    </div>
                    <div class="form-group">
                      <label for="search">Search for coins:</label>
                      <div class="input-group mb-3">
                        <input type="text" class="form-control" id="search" placeholder="Search for coins">
                        <div class="input-group-append">
                          <button class="btn btn-outline-secondary" type="button" id="searchButton">Search</button>
                        </div>
                      </div>
                      <ul id="searchResults" style="list-style-type: none; padding: 0;"></ul>
                    </div>
                    <div class="mb-3">
                      <label for="added-coins" class="form-label">Added Coins</label>
                      <ul class="list-group" id="added-coins">
                        <!-- Added coins will be listed here with delete functionality -->
                      </ul>
                    </div>
                    <button type="submit" class="btn btn-primary">Create Watchlist</button>
                  </form>
                </div>
              </div>
            </div>
          </div>

          <button class="nav-link active" id="v-pills-home-tab" data-bs-toggle="pill" data-bs-target="#v-pills-coinTable" type="button" role="tab" aria-controls="v-pills-watchlist1" aria-selected="true" onclick="getChart('https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&category=binance-smart-chain&per_page=10&page=1&sparkline=true&price_change_percentage=1h%2C24h%2C7d&locale=en');clearChart()">Watchlist 1</button>
        </div>
        <div class="tab-content" id="v-pills-tabContent">

          <div class="tab-pane fade show active" id="v-pills-home" role="tabpanel" aria-labelledby="v-pills-coinTable-tab">
            <div class="container">
              <section class="row">
                <table class="table table-dark">
                  <thead id="tableHead">
                  <tr>
                    <th scope="col">#</th>
                    <th scope="col" style="cursor:pointer;" onclick="sortTable(0)">name</th>
                    <th scope="col">ticker</th>
                    <th scope="col">price</th>
                    <th scope="col">1h</th>
                    <th scope="col">24h</th>
                    <th scope="col">7d</th>
                    <th scope="col" style="cursor:pointer;">volume</th>
                    <th scope="col">marketcap</th>
                    <th scope="col">24h Hi</th>
                    <th scope="col">24h Lo</th>
                    <th scope="col">Candles</th>
                    <th scope="col">Last 7 days</th>
                  </tr>
                  </thead>
                  <tbody id="coinChart"></tbody>
                </table>
              </section>

              <!--live chart-->
              <section>
                <div class="row">

                  <div id="coin-description"></div>


                  <div id="chartButtons"></div>
                  <div style="position:relative" id="liveChart"></div>
                  <div id="chartBottom"></div>
                </div>



              </section>
            </div> <!--DOM populate -->

          </div>
        </div>
      </div>
    </section>

  </div>
</main>
<script src="https://code.jquery.com/jquery-3.6.4.min.js" crossorigin="anonymous"></script>
<script src="/path/to/jquery-sparkline.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-sparklines/2.1.2/jquery.sparkline.min.js"></script>
<script src="/js/dashboard.js"></script>

<!--scripts-->
<script>
  let topBtn = document.getElementById("topBtn");

  // When the user scrolls down 20px from the top of the document, show the button
  window.onscroll = function() {scrollFunction()};

  function scrollFunction() {
    if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
      topBtn.style.display = "block";
    } else {
      topBtn.style.display = "none";
    }
  }

  function topFunction() {
    document.body.scrollTop = 0;
    document.documentElement.scrollTop = 0;
  }

</script>



</body>
</html>

